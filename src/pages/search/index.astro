---
import Base from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
---
<Base title="Search — Artagon" description="Search the site — Verified. Private. Attested.">
  <Fragment slot="header"><Header /></Fragment>
  <main class="container">
    <h1>Search</h1>
    <div class="container" style="margin-top:10px">
      <div id="docsearch"></div>
      <div id="docsearch-fallback" class="card" style="margin-top:12px;display:none">
        <strong>Site search not configured.</strong><br/>
        Add your DocSearch keys to <code>/docsearch.json</code> to enable instant search.
      </div>
    </div>
    <section id="results" style="margin-top:20px"></section>
  </main>
  <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
  <script>
  (async function(){
    try{
      const res = await fetch('/docsearch.json', {cache:'no-store'});
      if(!res.ok) throw new Error('docsearch.json missing');
      const cfg = await res.json();
      if(!cfg.appId || !cfg.apiKey || !cfg.indexName){ document.getElementById('docsearch-fallback').style.display='block'; return; }
      // @ts-ignore
      docsearch({ container:'#docsearch', appId: cfg.appId, apiKey: cfg.apiKey, indexName: cfg.indexName });
    }catch(e){ document.getElementById('docsearch-fallback').style.display='block'; }
  })();
  </script>
  <Fragment slot="footer"><Footer /></Fragment>
</Base>
